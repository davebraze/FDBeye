<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interest Areas for Text Stimuli • FDBeye</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Interest Areas for Text Stimuli">
<meta property="og:description" content="FDBeye">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FDBeye</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.21.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/InterestAreas1.html">Interest Areas for Text Stimuli</a>
    </li>
    <li>
      <a href="../articles/InterestAreas2.html">Interest Areas for Data Analysis</a>
    </li>
    <li>
      <a href="../articles/textcanvas1.html">Text Canvases 1: Basics &amp; SRR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/davebraze/FDBeye/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="InterestAreas1_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Interest Areas for Text Stimuli</h1>
                        <h4 data-toc-skip class="author">Jenna Duclos</h4>
            
            <h4 data-toc-skip class="date">October 25, 2016</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/davebraze/FDBeye/blob/HEAD/vignettes/InterestAreas1.Rmd" class="external-link"><code>vignettes/InterestAreas1.Rmd</code></a></small>
      <div class="hidden name"><code>InterestAreas1.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="building-dataviewer-compatible-interest-area-files">Building DataViewer Compatible Interest Area Files<a class="anchor" aria-label="anchor" href="#building-dataviewer-compatible-interest-area-files"></a>
</h2>
<p>Eye movement data can be analyzed by using interest area definitions to pick out specific screen areas for summarizing local gaze behavior. For reading experiments, interest areas may focus on a single word or multi-word units depending on needs of the analysis. Given an interest area specification, SRR DataViewer can generate an interest area report to provide information on various gaze measures for each area: fixation count, summed fixation duration, regressions into an interest area, etc.</p>
<div class="section level3">
<h3 id="using-r-package-fdbeye-to-create-srr-interest-area-files">Using R Package FDBeye to Create SRR Interest Area Files<a class="anchor" aria-label="anchor" href="#using-r-package-fdbeye-to-create-srr-interest-area-files"></a>
</h3>
<p>At this point we assume that the user has created paired bitmap (used as experimental stimuli in, e.g., SRR Experiment Builder) and comma separated <strong>region</strong> files. File names for the latter will typically end with “region.csv”. The R package FDBeye can be used to translate region files into Interest Area files (.ias files) compatible with SRR DataViewer.</p>
<p>The following R packages are required:</p>
<ul>
<li><a href="https://github.com/davebraze/FDButils" class="external-link">FDButils</a></li>
<li><a href="https://github.com/davebraze/FDBeye" class="external-link">FDBeye</a></li>
<li><a href="https://cran.r-project.org/web/packages/ggplot2/index.html" class="external-link">ggplot2</a></li>
<li><a href="https://cran.r-project.org/web/packages/readr/index.html" class="external-link">readr</a></li>
<li><a href="https://cran.r-project.org/web/packages/stringr/index.html" class="external-link">stringr</a></li>
<li>
<a href="https://cran.r-project.org/web/packages/yaml/index.html" class="external-link">yaml</a> (used internally-do not need to load)</li>
</ul>
<div class="section level4">
<h4 id="steps-to-get-from-a--region-csv-file-to-an-srr--ias-file-">Steps to get from a <code>*.region.csv</code> file to an SRR <code>*.ias</code> file.<a class="anchor" aria-label="anchor" href="#steps-to-get-from-a--region-csv-file-to-an-srr--ias-file-"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Read the <code>*.region.csv</code> file into a data.frame.</li>
<li>Use its content to generate a region definition character vector.</li>
<li>Write the region definition vector to a region.def file.</li>
<li>Hand edit the region.def file to specify the desired regions.</li>
<li>Use the region.def file to generate an <code>*.ias</code> file suitable for use in DataViewer.</li>
</ol>
<p>Here are the first three steps in R code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"trial1.region.csv"</span>, trim_ws<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reg2regdef.html">reg2regdef</a></span><span class="op">(</span><span class="va">reg</span>, mrgn.left<span class="op">=</span><span class="fl">86</span>, rgn.maxH<span class="op">=</span><span class="fl">60</span>, rgn.minH<span class="op">=</span><span class="fl">43</span>, rgn.padL<span class="op">=</span><span class="fl">18</span>, rgn.padR<span class="op">=</span><span class="fl">18</span><span class="op">)</span>
<span class="va">outf</span> <span class="op">&lt;-</span> <span class="st">"trial1.region.def"</span>
<span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">tmp</span>, con<span class="op">=</span><span class="va">outf</span><span class="op">)</span></code></pre></div>
<p>The region definition file will typically end with <code>*.region.def</code>. Once the file is saved to the working directory it can be hand edited in any text editor. The text document will include a block of information text layout on the screen as seen by the study participants. This appears in a ‘yaml’ block at the beginning of the file. Some of this information is read directly from the <code>region.csv</code> file, and some is specified in the function call <code><a href="../reference/reg2regdef.html">reg2regdef()</a></code>. It is easiest to specify this information when the region definition file is created, rather than hand editing it in the <code>region.def</code> file.</p>
<p>The text you want to edit to specify interest area locations will be at the bottom of the <code>*.region.def</code> file and will look something like this:</p>
<pre><code>The quick brown fox jumps over the lazy dog.
...|.....|.....|...|.....|....|...|....|....</code></pre>
<p>Each line of a text stimulus is paired with a ‘regioning string’. Within a regioning string, each letter and punctuation mark in the stimulus sentence is marked with a dot, “<strong>.</strong>”, and regions are separated with pipe character, “<strong>|</strong>”. The pipe character marks the first character of a new region. In this example, all regions in the stimulus sentence but the first will begin with a “space”. (The first region of a line always begins with the first character.) To edit locations of the interest areas, add or remove “<strong>|</strong>” characters from the regioning string. Note that the regioning string must be the same length as its paired text line. To maintain the same length between text line and regioning string, any removed “<strong>|</strong>” must be replaced with a “<strong>.</strong>”.</p>
<p>An edited regioning string in the text document will look like this:</p>
<pre><code>The quick brown fox jumps over the lazy dog.
...................|.....|........|.........</code></pre>
<p>Once you have hand edited the text document to reflect the interest area locations you want, save the file.</p>
</div>
<div class="section level4">
<h4 id="preview-the-new-interest-areas">Preview the new interest areas:<a class="anchor" aria-label="anchor" href="#preview-the-new-interest-areas"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Use the <code>*.region.def</code> file to build a set of regions.</li>
<li>Load the bitmap corresponding to the regions.</li>
<li>Plot the new interest areas over the bitmap.</li>
</ol>
<p>Here are the steps in R code:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ias2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regdef2ias.html">regdef2ias</a></span><span class="op">(</span><span class="st">"trial1.region2.def"</span><span class="op">)</span>
<span class="fu">write_delim</span><span class="op">(</span><span class="va">ias2</span>, <span class="st">"trial1.region2.ias"</span>, <span class="st">"\t"</span>, col_names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">fp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fixPlot.html">fixPlot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, y<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,
              bgImage <span class="op">=</span> <span class="st">"trial1.png"</span>, bgAlpha<span class="op">=</span><span class="fl">1</span>,
              xyMap <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">'x'</span>, y<span class="op">=</span><span class="st">'y'</span><span class="op">)</span>,
              pointMap<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
              <span class="op">)</span>
<span class="va">fp2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">ias2</span>, inherit.aes<span class="op">=</span><span class="cn">FALSE</span>,
               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin<span class="op">=</span><span class="va">x1</span><span class="op">+</span><span class="fl">1</span>, xmax<span class="op">=</span><span class="va">x2</span>, ymin<span class="op">=</span><span class="va">y1</span>, ymax<span class="op">=</span><span class="va">y2</span>,
                   fill<span class="op">=</span><span class="cn">NULL</span>, color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">regnum</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Note that for our purposes, we renamed the <code>*region.def</code> file to reflect the changes made (<code>*region.def</code> &gt; <code>*region2.def</code>). We chose to save and document the process and all the steps included in generating the new interest areas. Unless specified in your own code to be saved with a new name, the original <code>*region.def</code> and <code>*.ias</code> files will be overwritten.</p>
<p>Once the bitmaps and interest area regions have been displayed in R Plots you can visualize the regions as they will appear in DataViewer. If the text regions are not what you want/expect, then you can re-edit your <code>*region.def</code> file, and re-run regdef2ias(), and reload the plot. If the top and bottom boundaries of the regions are not placed appropriately, they can be adjusted by changing argument values rgn.maxH, and rgn.minH to <code><a href="../reference/reg2regdef.html">reg2regdef()</a></code>. See help page for that function.</p>
<pre><code><span class="fu"><a href="../reference/reg2regdef.html">reg2regdef</a></span><span class="op">(</span><span class="va">reg</span>, mrgn.left<span class="op">=</span><span class="fl">86</span>, rgn.maxH<span class="op">=</span><span class="fl">60</span>, rgn.minH<span class="op">=</span><span class="fl">43</span>, rgn.padL<span class="op">=</span><span class="fl">18</span>, rgn.padR<span class="op">=</span><span class="fl">18</span><span class="op">)</span></code></pre>
<p>It is recommended that one <code>*region.def</code> file be hand edited and one <code>*.ias</code> file be generated and checked for accuracy before creating multiple files. Then when you are sure the interest areas locations are appearing as you would like you can generate a full set of region definition files to edit.</p>
</div>
<div class="section level4">
<h4 id="create-all-the-region-def-and--ias-files-you-need">Create all the <code>*region.def</code> and <code>*.ias</code> files you need:<a class="anchor" aria-label="anchor" href="#create-all-the-region-def-and--ias-files-you-need"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Set your working directory to the folder containing all of the <code>*region.csv</code>.</li>
<li>Make a vector of all the files located in your working directory and remove all files that are not <code>*region.csv</code>.</li>
<li>Using a loop function, create one <code>*region.def</code> for each <code>*region.csv</code>.</li>
<li>Hand edit the regioning string in each <code>*region.def</code>.</li>
<li>Then return to R and make a vector of all the files located in your working directory and remove all files that are not <code>*region.def</code>.</li>
<li>Using a loop function, create one <code>*.ias</code> for each <code>*region.def</code>.</li>
</ol>
<p>Here are steps 2-3 in R code:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">flist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">flist</span> <span class="op">&lt;-</span> <span class="va">flist</span><span class="op">[</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">flist</span>, <span class="st">"region[.]csv"</span><span class="op">)</span><span class="op">]</span> <span class="co">## change the regexp as needed to pick out your files</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">ff</span> <span class="kw">in</span> <span class="va">flist</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="va">ff</span>, trim_ws<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">rdef</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reg2regdef.html">reg2regdef</a></span><span class="op">(</span><span class="va">reg</span>, mrgn.left<span class="op">=</span><span class="fl">86</span>, rgn.maxH<span class="op">=</span><span class="fl">60</span>, rgn.minH<span class="op">=</span><span class="fl">43</span>, rgn.padL<span class="op">=</span><span class="fl">18</span>, rgn.padR<span class="op">=</span><span class="fl">18</span><span class="op">)</span>
    <span class="va">outf</span> <span class="op">&lt;-</span> <span class="fu">str_replace</span><span class="op">(</span><span class="va">ff</span>, <span class="st">"region.csv$"</span>, <span class="st">"region2.def"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">rdef</span>, con<span class="op">=</span><span class="va">outf</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Here are steps 5-6 in R code:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">flist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">flist</span> <span class="op">&lt;-</span> <span class="va">flist</span><span class="op">[</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">flist</span>, <span class="st">"region2[.]def"</span><span class="op">)</span><span class="op">]</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">ff</span> <span class="kw">in</span> <span class="va">flist</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">ias</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regdef2ias.html">regdef2ias</a></span><span class="op">(</span><span class="va">ff</span><span class="op">)</span>
    <span class="va">outf</span> <span class="op">&lt;-</span> <span class="fu">str_replace</span><span class="op">(</span><span class="va">ff</span>, <span class="st">"def$"</span>, <span class="st">"ias"</span><span class="op">)</span>
    <span class="fu">write_delim</span><span class="op">(</span><span class="va">ias</span>, <span class="va">outf</span>, delim<span class="op">=</span><span class="st">"\t"</span>, col_names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Now that your interest area files have been created for each trial you will need to load them into DataViewer. For these steps refer to <strong>Interest Areas for Data Analysis</strong>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David Braze, Tao Gong, Monica Li, Jenna Duclos.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
