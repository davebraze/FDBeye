<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate locations of text lines within text canvases. — getLines • FDBeye</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate locations of text lines within text canvases. — getLines"><meta property="og:description" content="None yet"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FDBeye</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.21.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/InterestAreas1.html">Interest Areas for Text Stimuli</a>
    </li>
    <li>
      <a href="../articles/InterestAreas2.html">Interest Areas for Data Analysis</a>
    </li>
    <li>
      <a href="../articles/textcanvas1.html">Text Canvases 1: Basics &amp; SRR</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/davebraze/FDBeye/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate locations of text lines within text canvases.</h1>
    <small class="dont-index">Source: <a href="https://github.com/davebraze/FDBeye/blob/HEAD/R/textCanvas.R" class="external-link"><code>R/textCanvas.R</code></a></small>
    <div class="hidden name"><code>getLines.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>None yet</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">getLines</span><span class="op">(</span><span class="va">canvas</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>canvas</dt>
<dd><p>A N dimensional matrix (product of png::readPNG()) corresponding to a bitmap image
containing rasterized text.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame containing 1 row for each line of text in the canvas, and the following
    columns:</p><ol><li><p>line: Integer indicating text line number, counting from the top of the canvas.</p></li>
<li><p>top: Integer indicating upper extent of line in pixels.</p></li>
<li><p>baseline: Integer indicating location of line's baseline (estimated) in pixels. NOT YET IMPLEMENTED.</p></li>
<li><p>bottom: Integer indicating lower extent of line in pixels.</p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function, and it's companions getChars() and GetMargins(), are utilities designed to
    extract details of text position in a bitmap file, a text canvas, as we'll call it here. A
    text canvas is simply a bitmap that contains one or more lines of text. The text is assumed
    to be organized as it would be on a printed page.</p>
<p>In our own lab we generate text canvases programmatically to use as stimulus items in the
    context of experiment control software (ECS) like SRR's Experiment Builder, or PST's
    E-Prime. The Python scripts we use for the purpose also generate region files (AKA area of
    interest files, etc). Because we build the text canvases ourselves, we have precise control
    over the locations of words within them.</p>
<p>Another approach to displaying text in an experiment is to let the ECS build the text
    canvases from plain text representations of the stimuli. That's the standard way of
    presenting text (sentences, paragraphs, whatever) in SRR Experiment Builder, for
    example. However, EB will generate text canvases for each trial based on the text provided
    to it. These are pre-compiled and stored in a specific directory under the deployed EB
    script. So, if your EB script is named "SentenceReading", then it will live in a directory
    with that same name. Any screen displayed in the execution of the script, including text
    canvases, will be in a sub-folder called "runtime/images".</p>
<p>Sadly, these files will have unhelpful names consisting of a long string of numbers, like
    "307641742100813627.png". And, as noted "runtime/images" will also also contain png files
    for screens other than the text canvases used as experimental stimuli, with no hint in the
    file names as to which are which. So, the only way to separate out the text canvases of
    interest is to go through the files manually and sort them out. (To be clear, I think this
    is a problem that is not specific to EB. I guess any experiment control software will have a
    similar issue.)</p>
<p>But, once you have those stimulus files, you may want to parse out the locations of text in
    the files so you can do some reanalysis based on regions of interest other than those that
    were specified prior to data acquisition. Certainly, this could be done by making manual
    measurements of each text canvas, but the functions, getLines(), getChars(), and
    getMargins() are designed to at least partially automate the process.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>TODO: Work on getting top and bottom bounds for each line, as well as estimated baseline.</p>
<p>TODO: Find out if there is a way to interpret the filenames of bitmaps located in SRR EB
    script subdirectory "runtime/images" in a meaningful way. Most helpful would be to get a
    list of those files that SRR DataViewer knows to used as background images for a specific
    EDF file.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Dave Braze &lt;davebraze@gmail.com&gt;</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">    <span class="va">cnvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/story01.png"</span>, package<span class="op">=</span><span class="st">"FDBeye"</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">cnvs</span> <span class="op">&lt;-</span> <span class="fu">png</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/png/man/readPNG.html" class="external-link">readPNG</a></span><span class="op">(</span><span class="va">cnvs</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">fcnvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">cnvs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span> <span class="co"># flatten to a single plane for convenience</span></span>
<span class="r-in"></span>
<span class="r-in">    <span class="co">## get lines</span></span>
<span class="r-in">    <span class="fu">getLines</span><span class="op">(</span><span class="va">fcnvs</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>the condition has length &gt; 1 and only the first element will be used</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       line top baseline bottom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1  73       NA     89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    2 134       NA    150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    3 195       NA    211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    4 256       NA    272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    5 319       NA    335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    6 384       NA    400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    7 445       NA    461</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    8 506       NA    522</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    9 567       NA    583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]   10 628       NA    644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]   11 689       NA    705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]   12 754       NA    770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]   13 815       NA    831</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Braze, Tao Gong, Monica Li, Jenna Duclos.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

